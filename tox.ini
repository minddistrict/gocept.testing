[tox]
envlist = coverage-clean,
          py27,
          py34,
          py35,
          py36,
          py37,
          coverage-report,
          flake8
minversion = 1.6


[testenv:coverage-clean]
deps = coverage
setenv =
  COVERAGE_FILE=.coverage
skip_install = true
commands = coverage erase

[testenv]
deps =
    .[test]
    pytest
    pytest-cov
    pytest-remove-stale-bytecode
    pytest-sugar
    pytest-timeout
commands = py.test {posargs}
usedevelop = True
setenv =
  COVERAGE_FILE=.coverage.{envname}

[testenv:coverage-report]
deps = coverage
setenv =
  COVERAGE_FILE=.coverage
skip_install = true
commands =
    coverage combine
    coverage report
    coverage html
    coverage xml

[testenv:flake8]
basepython = python3.6
deps = flake8
commands = flake8 src setup.py --doctests
